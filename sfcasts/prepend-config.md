# Prepend Config

I'm *pretty* sure that our new `item_view` is configured correctly. We have `item\value_type: contentful_entry`, which I *know* is correct, and then we're using `contentful\content_type` set to `skills` that *only* applies to our skills from Contentful. But it doesn't seem to be working on the frontend. Earlier, when we ran `debug:config`, we saw that the *problem* lies with the *order* of our config. Layouts reads from top to bottom when deciding which item template to use. So it looks at this one here first, sees that the `value_type` *is* `contentful_entry`, and just stops. To fix this, we need to *reverse* our config.

So... why is it in this order to begin with? This just happens to be how Symphony loads config. It loads vendor config *first*, like the kind from our Contentful package (this is actually from Netgen Layouts itself), and then it loads *our* config. That's *usually* the order we want our config to be in, but in *this* case, we want the opposite. How do we accomplish that? By asking Symphony to *prepend* our configuration.

To do that, in the `/config` directory, I'm going to create a new directory called `/prepends` and move our Netgen Layout configuration into it. I'm doing this so Symphony stops automatically loading our `/config/packages` in the normal way.

At this point, *nothing* is loading our new `/prepends` directory. The next step is a little technical. We need to create an "extension class". Let's call it `AppExtension`, and then I'll just paste in the code. You can grab this from the code block on this page. Basically, when this `prepend()` function is called, we're going to go load that file from `/prepends` and essenitally *push* it onto the configuration. This is a long way of loading that configuration file, but we're doing it in a way that's going to *prepend* that configuration.

To get this file to be called, we're going to go to our `Kernel` class and make a small change after `use MicroKernelTrait`. Say `configureContainer as baseConfigureContainer`. What we're doing is aliasing the `configureContainer` method from `MicroKernelTrait` *into* this class, but we're *renaming* it `baseConfigureContainer`. We're doing this so we can define our *own* `configureContainer`. I'll copy this `configureContainer` method from the traits, hit "OK" to add the `use` statements, and then call `$this->baseConfigureContainer()` and pass in those arguments: `$container`, `$loader`, and `$builder`.

The `configureContainer` method in the trait is responsible for loading all of the `/config/package` directory, `services.yaml`, etc. - all the normal stuff we want. We still want that to happen, but after it does that, we're going to say `$builder->registerExtension(new appExtension())`. This is a little technical, but those two pieces together are going to cause our configuration file to be prepended. Check it out! Let's rerun our `debug:config` command again, scroll to the top, and... yes! Our configuration is *now* on top! And when we refresh... woohoo! We see our text!

All right, let's finish this template. We already have what we want the featured skills to look like, so let's go to `/templates/main/homepage.html.twig`, find `featured_skills`, copy what *one* of those skills looks like, and paste that into `skill.html.twig`. I'm also going to add `dump(item.object)` at the top here. We've done item templates before, so we know `item.object` *should* give us the underlying object, `contentful_entry`. If we head over and refresh... *awesome*!

This is an intensive `contentful_entry` and you can't really see it from here, but the most important thing to know about this is that it has a `get` method where you can read *any* of the underlying data from Contentful. In this case, if I dig a little here..., I have fields like `title` and `shortDescription`. We can use those keys to read those values. For example, on the `<h3>` here, I can say `{{ item.object.get('title') }}`. Then, over here... that rendered the title!

All right, let's finish everything else up. For the `<img src=""{{ }}>`, let's replace this `asset()` stuff with `item.object.get('image')`, followed by `.file.url`, which is specific to Contentful. I'm also going to go over to the `alt` and say `item.object.get('title')` *there* as well.

The last thing we need to adjust is the URL. This is a little weird, and it's specific to how our dynamic pages are being created with our CMS system. In this case, the dynamic URLs are being added by the CMF routing bundle. To link to this, we're going to add `path('cmf_routing_object')`. Then we can pass `_route_object` set to `item.object`. If you were using Sylius or Ibexa CMS, you would use some function from *their* system to create this link. If we head over and try that... yes! And if we click on it... it *works*.

All right, so let's celebrate by getting rid of that `dump()`... and let's actually take the `featured_skills` stuff out of our homepage template. We don't need that at all anymore. We can also remake this `<h2>` inside of our admin area. Let's do that really quick while we're already here.Add a Title block called "Featured Skills", and we'll make that "Heading 2"... and give it that same CSS class - `text-center mb-4`. I have this inside of a container already, so let's add a Column here. I'll wrap *that* in a Container, and then we can move our Grid and our Title inside of it. We won't need a Container right *there* anymore, and I'll also delete this "featured_skills" Twig block down here *entirely*. Cool! Let's "Publish and continue editing"... I'll clean up this extra space here... move over and refresh, and... how cool is that?!

Okay, while we're talking about item views, let's customize the item template for our *other* content model inside of Contentful: The *Advertisement*. We're only rendering this in *one* place, on a specific skill page right over... *here*. Let's go check that out. I'll open the *individual* skill layout. As a reminder, we did this by using the `contentful_entry` field, and we're using an *advertisement*, which is a "referenced entity". If you modify a skill, you can see that the field down here is actually a way to dynamically select related entities.

If you go to your web debug toolbar, search for "item", and scroll down here... you can see that we're once again using the item template. Here's `contentful_entry_field/entries.html.twig`, and then it loops over all of your related entries and, for each one, renders the item template. This is rendering the standard item template, and we already know how to override that.

Head over to our configuration, copy the `contentful_entry/skill`, and paste it below. We'll replace `skill` with `ad` and we'll do the same thing down here for our `template` path. Finally, replace `skill` for our `content_type` with `advertisement`. Everything else here will stay the same. We changed this because, over in Contentful, our Content Model is called "Advertisement". Now let's go create that template. Over here, create a new file called `ad.html.twig`, and then just add some text - `Advertisement`. If we go back and refresh... got it! That was easy!

For the *real* template contents, I'll just paste some in. Once again, we'll use `item.object.get()` and we'll have it read the `url` field. There's also an `image` field and a `shortText` field on each advertisement. And now... *we've got it*!

Next: What if we wanted to create a Grid of items on our site, but make that single Grid look different than all the others? We can do that by creating an extra block view for an existing block.
